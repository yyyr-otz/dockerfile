name: æ‰§è¡Œå‘½ä»¤å¹¶æäº¤æ›´æ”¹
run-name: ${{ github.actor }} æ­£åœ¨æ‰§è¡Œå‘½ä»¤

on:
  workflow_dispatch:
    inputs:
      command:
        description: 'è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼šmv dir_a dir_bï¼‰'
        required: true

permissions:
  contents: write  # å…è®¸å†™å…¥ä»“åº“

jobs:
  execute:
    runs-on: ubuntu-latest
    steps:
      # 1. æ£€å‡ºä»£ç ï¼ˆå®Œæ•´å…‹éš†ï¼‰
      - name: ğŸ› ï¸ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # å®Œæ•´å…‹éš†å†å²è®°å½•

      # 2. æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤
      - name: ğŸ”¥ æ‰§è¡Œå‘½ä»¤
        run: |
          # æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤
          ${{ inputs.command }}

          # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å˜æ›´ï¼ˆåŒ…æ‹¬ç§»åŠ¨/é‡å‘½åï¼‰
          if ! git diff --quiet; then
            echo "æ£€æµ‹åˆ°æ–‡ä»¶å˜æ›´ï¼Œå‡†å¤‡æäº¤..."
            # è‡ªåŠ¨å¤„ç†æ–‡ä»¶ç§»åŠ¨/åˆ é™¤/æ–°å¢ï¼ˆgit add -Aï¼‰
            git add -A
          else
            echo "âš ï¸ æœªæ£€æµ‹åˆ°æ–‡ä»¶å˜æ›´ï¼Œè·³è¿‡æäº¤"
            exit 0
          fi

      # 3. æäº¤å˜æ›´åˆ°ä»“åº“
      - name: ğŸš€ æäº¤æ›´æ”¹
        if: success()
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git commit -m "æ‰§è¡Œå‘½ä»¤: ${{ inputs.command }}"
          git push
